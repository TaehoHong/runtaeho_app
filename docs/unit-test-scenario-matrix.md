# RunTaeho Unit Test Scenario Matrix

- Scope: Unit-only (`model/store/hook/query/screen`), E2E excluded.
- Feature order applied: `auth -> running -> league -> user -> point -> statistics`
- Effectiveness rule for all scenarios: `Risk linked + result/side-effect assertions + >=1 negative assertion + isolated mocks/state reset`
- Status legend: `PASS` means test pass + scenario mapping validated.

## Auth
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| AUTH-JWT-001 | jwtUtils 약관 파싱 | Given 유효 JWT, When `isAgreedOnTermsFromToken`, Then 약관 동의 true/false 정확 파싱 | 인증 상태 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/jwtUtils.test.ts | PASS | payload 파싱값 검증 + malformed 토큰 부정 단정 분리 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-JWT-002 | jwtUtils 예외 처리 | Given malformed token, When 파싱, Then false 반환 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/jwtUtils.test.ts | PASS | false 반환 + 예외 전파 없음 + not.toThrow 성격 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-JWT-003 | jwtUtils 만료 분기 | Given valid/soon/expired 토큰, When `verifyToken`, Then 상태값 분기 정확 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/jwtUtils.test.ts | PASS | VALID/SOON/EXPIRED 비교 + 남은시간 0 경계 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-HOOK-001 | useAuth verify no-token | Given access token 없음, When `verifyAndRefreshToken`, Then false | 인증 상태 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/useAuth.test.tsx | PASS | false 반환 + `isLoggedIn` false + 토큰 조회 1회 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-HOOK-002 | useAuth completeLogin | Given userData 조회 성공, When `completeLogin`, Then store/token 동기화 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/useAuth.test.tsx | PASS | `saveTokens`, `isLoggedIn`, `currentUser`, sentry context 인자 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-HOOK-003 | useAuth side-effect guard | Given no-token 경로, When verify 수행, Then user fetch/login side-effect 없음 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/useAuth.test.tsx | PASS | 로그인 상태 미변경 + 불필요 refresh 흐름 없음(부정 단정) | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-SIGNIN-001 | useAuthSignIn Google 성공 | Given Google auth 성공, When sign-in 실행, Then 로딩 해제/완료 | 인증 상태 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/useAuthSignIn.test.tsx | PASS | 성공 경로 호출 순서 + loading state 종료 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-SIGNIN-002 | useAuthSignIn 취소 처리 | Given AuthError CANCELLED, When sign-in, Then alert 미노출 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/useAuthSignIn.test.tsx | PASS | 취소 시 알림 부정 단정 + 조용한 종료 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-SIGNIN-003 | useAuthSignIn provider unavailable | Given provider unavailable, When sign-in, Then 에러 alert 표시 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/useAuthSignIn.test.tsx | PASS | 알림 호출 횟수/메시지 검증 + 성공 흐름 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-STORE-001 | authStore 상태 전이 | Given 초기 상태, When 토큰/로그인 액션, Then 상태 전이 정확 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/authStore.test.ts | PASS | setter 후 state snapshot 검증 + logout reset | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-STORE-002 | authStore 초기화 | Given secure storage 토큰 존재, When init, Then in-memory 반영 | 인증 상태 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/authStore.test.ts | PASS | `initializeTokens` 결과 + token field 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| AUTH-STORE-003 | authStore fallback | Given 메모리 토큰 없음, When get token, Then secure storage fallback | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/auth/__tests__/authStore.test.ts | PASS | fallback 호출 검증 + 메모리 토큰 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## Running
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| RUN-SVC-001 | runningService 시작 매핑 | Given start payload, When start API, Then request DTO 매핑 정확 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/runningService.test.ts | PASS | API 인자/응답 매핑 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SVC-002 | runningService 페이지 정렬 | Given 다중 페이지, When loadAll, Then timestamp desc 정렬 | 회귀(데이터정합) | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/runningService.test.ts | PASS | merged id 순서 검증 + 실패 케이스 분리 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SVC-003 | runningService 예외 전파 | Given API 실패, When 조회, Then 에러 전파 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/runningService.test.ts | PASS | reject 검증 + 성공 경로 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SEG-001 | useRunningSegments 세그먼트 생성 | Given 임계거리 도달, When update, Then segment 생성 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useRunningSegments.test.tsx | PASS | segment count/값 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SEG-002 | useRunningSegments 경계 | Given 비양수 거리 변화, When update, Then segment 미생성 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useRunningSegments.test.tsx | PASS | 배열 길이 unchanged 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SEG-003 | useRunningSegments finalize/reset | Given 진행중 세그먼트, When finalize/reset, Then 상태 초기화 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useRunningSegments.test.tsx | PASS | finalize 결과 + reset 후 empty 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-LIFE-001 | useRunningLifecycle 시작 성공 | Given 권한 허용, When start, Then GPS/pedometer 초기화 | 인증/상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useRunningLifecycle.test.tsx | PASS | startGps/initSegment 호출 + stopTracking 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-LIFE-002 | useRunningLifecycle 종료 실패 fallback | Given end API 실패, When end, Then offline upload fallback | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useRunningLifecycle.test.tsx | PASS | offline queue 호출 + 실패 예외 분리 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-LIFE-003 | useRunningLifecycle 경계 종료 | Given 거리 10m 미만, When end, Then end API 스킵 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useRunningLifecycle.test.tsx | PASS | `endRunning` mutation 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SCREEN-001 | RunningStartView 시작 성공 | Given 권한 허용, When 시작 버튼, Then Running 상태 전환 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/RunningStartView.test.tsx | PASS | `setRunningState` 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SCREEN-002 | RunningStartView 권한 거부 | Given 권한 거부, When 시작 버튼, Then 권한 모달 표시 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/RunningStartView.test.tsx | PASS | modal 표시 + start 호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| RUN-SCREEN-003 | RunningStartView 예외 | Given `startRunning` throw, When 시작, Then 상태 전환 유지 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/RunningStartView.test.tsx | PASS | exception 상황에서도 상태 전환 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## League
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| LEAGUE-MODEL-001 | League 승강등 경계 | Given rank 경계값, When promotion 계산, Then 승/강등 상태 정확 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/LeagueModel.test.ts | PASS | 상/하위 경계 비교 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-MODEL-002 | League 진행도 계산 | Given 참가자/거리, When progress 계산, Then 0~1 범위 정규화 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/LeagueModel.test.ts | PASS | 결과 범위 + single participant 경계 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-MODEL-003 | League 결과 메시지 | Given 결과 enum, When message 변환, Then fallback 포함 정확 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/LeagueModel.test.ts | PASS | known/unknown enum 메시지 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-VM-001 | useLeagueViewModel not-joined | Given league data 없음, When hook 실행, Then `isNotJoined` true | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/useLeagueViewModel.test.tsx | PASS | empty state flag 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-VM-002 | useLeagueViewModel 에러 | Given query error, When hook 실행, Then `hasError` true | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/useLeagueViewModel.test.tsx | PASS | error flag/메시지 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-VM-003 | useLeagueViewModel join 성공 | Given join mutation 준비, When handleJoinLeague, Then mutation 호출 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/useLeagueViewModel.test.tsx | PASS | 호출 횟수/인자 + 부정 단정 포함 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-QUERY-001 | leagueQueries current fetch | Given enabled true, When query, Then current league fetch | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/leagueQueries.test.tsx | PASS | query data + service 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-QUERY-002 | leagueQueries disabled | Given enabled false, When unchecked-result query, Then fetch skip | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/leagueQueries.test.tsx | PASS | API 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-QUERY-003 | leagueQueries mutation invalidation | Given join/confirm 성공, When mutation, Then 캐시 invalidation | 회귀(캐시) | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/leagueQueries.test.tsx | PASS | invalidate/clear 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-SCREEN-001 | LeagueView 가입 전 | Given not joined, When render, Then 가입 전 UI 렌더 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/LeagueView.test.tsx | PASS | not-joined 문구/컴포넌트 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-SCREEN-002 | LeagueView 로딩/에러 | Given loading 또는 error, When render, Then 각 상태 UI 표시 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/LeagueView.test.tsx | PASS | loading/error 문구 분기 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| LEAGUE-SCREEN-003 | LeagueView 가입 후 | Given formatted data, When render, Then dashboard 위젯 표시 | 회귀(UI) | /Users/hongtaeho/running/runtaeho_app/src/features/league/__tests__/LeagueView.test.tsx | PASS | 핵심 위젯 존재 + 비정상 상태 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## User
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| USER-SVC-001 | userService.updateProfile FormData | Given nickname+image, When updateProfile, Then multipart 구성 정확 | 회귀(요청계약) | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/userService.test.ts | PASS | FormData 필드/파일 파트 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-SVC-002 | userService.updateProfile 이미지 생략 | Given nickname only, When updateProfile, Then 이미지 필드 없음 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/userService.test.ts | PASS | 이미지 필드 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-SVC-003 | userService.updateProfile 에러 전파 | Given API error, When updateProfile, Then reject 유지 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/userService.test.ts | PASS | reject 검증 + 성공 side-effect 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-QUERY-001 | userQueries fetch/skip | Given enabled on/off, When useGetUserById, Then fetch/skip 분기 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/userQueries.test.tsx | PASS | enabled true data, false API 미호출 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-QUERY-002 | userQueries invalidate | Given connect/disconnect 성공, When mutation, Then user key invalidate | 회귀(캐시) | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/userQueries.test.tsx | PASS | invalidateQueries 호출 인자 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-QUERY-003 | userQueries delete cache clear | Given delete 성공, When mutation, Then query cache clear | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/userQueries.test.tsx | PASS | clear 호출 + 후속 fetch 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-CONN-001 | useAccountConnection connect 성공 | Given Google/Apple 연결 가능, When connect, Then API+refresh 호출 | 인증 상태 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/useAccountConnection.test.tsx | PASS | strategy/API/refresh 호출 순서 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-CONN-002 | useAccountConnection cancel/already-connected | Given 취소 또는 이미 연결됨, When connect, Then API 미호출 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/useAccountConnection.test.tsx | PASS | alert 분기 + API 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-CONN-003 | useAccountConnection disconnect 가드 | Given 단일계정/다중계정, When disconnect, Then 차단 또는 확인 후 해제 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/useAccountConnection.test.tsx | PASS | Alert action 수동 실행 + disconnect/refresh 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-SET-001 | SettingsView logout 성공 | Given 로그아웃 확인, When confirm, Then logout + 로그인 이동 | 인증 상태 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/SettingsView.test.tsx | PASS | modal confirm 후 action 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-SET-002 | SettingsView logout 실패/취소 | Given 실패 또는 cancel, When 처리, Then alert 또는 no-op | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/SettingsView.test.tsx | PASS | 실패 alert, cancel 시 API 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| USER-SET-003 | SettingsView withdraw | Given withdraw confirm, When 실행, Then API/리다이렉트 또는 실패 alert | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/user/__tests__/SettingsView.test.tsx | PASS | success/fail/cancel 3분기 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## Point
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| POINT-MODEL-001 | Point 필터/변환 | Given 적립/사용 데이터, When filter/param 변환, Then 결과 정확 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointModel.test.ts | PASS | ALL/EARNED/SPENT + default fallback 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-MODEL-002 | Point 통계 계산 | Given 오늘/주간/과거 기록, When statistics 계산, Then total/today/weekly 정확 | 회귀(집계) | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointModel.test.ts | PASS | 합계/건수 검증 + spent 분리 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-MODEL-003 | Point 경계 검증 | Given invalid history 입력, When validate/sort, Then false/정렬 결과 반환 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointModel.test.ts | PASS | id/point/type/timestamp 경계 + not same reference 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-QUERY-001 | pointQueries skip/enabled | Given skip=true 또는 enabled=false, When query, Then API 미호출 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/pointQueries.test.tsx | PASS | 호출 0회 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-QUERY-002 | pointQueries infinite merge | Given page1/page2 cursor, When fetchNextPage, Then merged ids 유지 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/pointQueries.test.tsx | PASS | 1/2번째 호출 params + hasNextPage 경계 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-QUERY-003 | pointQueries recent/user point | Given startDate/point balance, When query, Then 파라미터 매핑 정확 | 회귀(요청계약) | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/pointQueries.test.tsx | PASS | timestamp/size=100 + getUserPoint 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-VM-001 | PointViewModel 초기/필터 | Given recent data, When filter 변경, Then filtered history 갱신 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointViewModel.test.tsx | PASS | 필터 결과 길이 + refetch 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-VM-002 | PointViewModel 필터 재조회 | Given older history 존재, When 필터 전환, Then older reset + refetch | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointViewModel.test.tsx | PASS | `refetchOlder` 호출 + 동일필터 재전환 시 미호출 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-VM-003 | PointViewModel refresh/loadMore 경계 | Given refresh empty 응답, When refresh/loadMore, Then cursor reset/추가조회 skip | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointViewModel.test.tsx | PASS | allRecent empty + loadMore 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-SCREEN-001 | PointHistoryView empty/loading | Given empty 또는 loading, When render, Then empty/로딩 UI 분기 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointHistoryView.test.tsx | PASS | list/empty 텍스트 존재 여부 분기 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-SCREEN-002 | PointHistoryView filter/loadMore guard | Given 탭 변경/hasMore false, When onEndReached, Then select 호출 또는 load skip | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointHistoryView.test.tsx | PASS | filter 인자 검증 + loadMore 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| POINT-SCREEN-003 | PointHistoryView refresh/close | Given pull-to-refresh/close 버튼, When 액션, Then refresh/onClose 호출 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/point/__tests__/PointHistoryView.test.tsx | PASS | refreshControl callback + close handler 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## Statistics
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| STAT-DATE-001 | dateHelpers 기간 시작/이동 | Given 기준일, When start/next 계산, Then 주/월/년 기준일 정확 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/dateHelpers.test.ts | PASS | startOfWeek/month/year + direction 분기 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-DATE-002 | dateHelpers 미래/라벨 분기 | Given 미래/현재 날짜, When future/label 계산, Then true/false 및 라벨 정확 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/dateHelpers.test.ts | PASS | WEEK/MONTH/YEAR + unknown default 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-DATE-003 | dateHelpers 기간 종료 경계 | Given 윤년 월말/연말, When endOfPeriod, Then 23:59:59 경계 정확 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/dateHelpers.test.ts | PASS | day/hour/min/sec + default lastDay 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-CALC-001 | statisticsCalculator 필터/그룹 | Given 다기간 레코드, When filter/group, Then period key/포함범위 정확 | 회귀(집계) | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/statisticsCalculator.test.ts | PASS | weekly/monthly/yearly/default 분기 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-CALC-002 | statisticsCalculator personal/trend | Given 기록 집합, When personal/trend 계산, Then best record/증감률 정확 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/statisticsCalculator.test.ts | PASS | fastest pace null 경계 + trend 100% 분기 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-CALC-003 | statisticsCalculator goal progress | Given 목표값/누락목표, When progress 계산, Then 퍼센트 또는 0 반환 | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/statisticsCalculator.test.ts | PASS | 각 progress >0 및 missing goals 0 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-QUERY-001 | statisticsQueries stable key | Given Date params, When hook, Then ISO queryKey 생성 | 회귀(캐시) | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/statisticsQueries.test.tsx | PASS | `queryKeys.statistics.summary` 정확 일치 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-QUERY-002 | statisticsQueries options | Given enabled false, When hook, Then query disabled + placeholder 유지 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/statisticsQueries.test.tsx | PASS | enabled false + `keepPreviousData` 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-QUERY-003 | statisticsQueries queryFn | Given queryFn 실행, When service 호출, Then params 원형 전달 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/statisticsQueries.test.tsx | PASS | service 인자 검증 + 변형 없음 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-SCREEN-001 | StatisticsView empty/error/loading | Given hasValidData false + error/loading, When render, Then 상태별 UI 분기 | UI 분기 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/StatisticsView.test.tsx | PASS | loading text/error message + 상호 배타 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-SCREEN-002 | StatisticsView period/swipe | Given 기본 월 상태, When 주 탭/스와이프, Then period/referenceDate 변경 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/StatisticsView.test.tsx | PASS | `useStatisticsViewModel` 마지막 호출 인자 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| STAT-SCREEN-003 | StatisticsView summary/refresh | Given formatted summary + pull refresh, When render/refresh, Then 요약값 렌더+refresh 호출 증가 | 회귀(UI) | /Users/hongtaeho/running/runtaeho_app/src/features/statistics/__tests__/StatisticsView.test.tsx | PASS | distance/pace 텍스트 + refresh call count 증가 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## Feature Gate Results
| Feature | Unit 실행 | Coverage 대상 | Coverage 결과 | 시나리오 검증 |
|---|---|---|---|---|
| auth | PASS | 기존 auth 대상 테스트 세트 | 통과(기존 게이트 유지) | PASS |
| running | PASS | runningService/useRunningSegments/useRunningLifecycle/RunningStartView | Statements 96.8 / Branches 60.86 | PASS |
| league | PASS | League model/useLeagueViewModel/leagueQueries/LeagueView | Statements 91.34 / Branches 85.96 | PASS |
| user | PASS | userService/userQueries/useAccountConnection/SettingsView | Statements 89.6 / Branches 72.3 | PASS |
| point | PASS | Point model/pointQueries/PointViewModel/PointHistoryView | Statements 91.94 / Branches 92.3 | PASS |
| statistics | PASS | dateHelpers/statisticsCalculator/statisticsQueries/StatisticsView | Statements 99.01 / Branches 84.68 | PASS |

## Lifecycle (Cross-Feature: AppStateProvider + Running)
| Scenario ID | 기능명 | Given/When/Then | Risk Type | Test File | Pass 여부 | 검증 근거(assert 핵심) | Validity | Fit | Validity 근거 | Fit 근거 |
|---|---|---|---|---|---|---|---|---|---|---|
| APP-LC-001 | background 저장 | Given 로그인 상태, When `background`, Then `backgroundEnterTime` 저장 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/providers/__tests__/AppStateProvider.lifecycle.test.tsx | PASS | `AsyncStorage.setItem('backgroundEnterTime', ...)` 호출 검증 + 사용자 포인트 동기화 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| APP-LC-002 | short foreground 복귀 | Given 백그라운드 300초 미만, When `active`, Then 기본 foreground 작업만 실행 | 동기화 | /Users/hongtaeho/running/runtaeho_app/src/providers/__tests__/AppStateProvider.lifecycle.test.tsx | PASS | `syncReadyState` 호출 + `resetGameObjectReady/getUserPoint` 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| APP-LC-003 | long foreground 복귀 | Given 백그라운드 300초 초과, When `active`, Then long-branch 실행 | 오류 복구/동기화 | /Users/hongtaeho/running/runtaeho_app/src/providers/__tests__/AppStateProvider.lifecycle.test.tsx | PASS | `resetGameObjectReady`, `getUserPoint` 호출 + `useUserStore.totalPoint` 반영 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| APP-LC-004 | stale Unity 복구 | Given `validateUnityState=false`, When `active`, Then Unity 강제 복구 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/providers/__tests__/AppStateProvider.lifecycle.test.tsx | PASS | `forceResetUnity` 호출 + 이후 `syncReadyState` 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| APP-LC-005 | foreground 중복가드 | Given foreground 작업 진행중, When `active` 연속 호출, Then 1회 실행 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/providers/__tests__/AppStateProvider.lifecycle.test.tsx | PASS | deferred Promise로 in-flight 유지 후 `getItem/syncReadyState` 호출수 1회 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| APP-LC-006 | 로그아웃 가드 | Given 로그아웃 상태, When `background/active`, Then 생명주기 동기화 스킵 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/providers/__tests__/AppStateProvider.lifecycle.test.tsx | PASS | `backgroundEnterTime` set/remove 미호출 + `getUserPoint/syncReadyState` 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-001 | 초기 polling 시작 | Given Running+active, When mount 후 1초, Then polling 시작 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `getTotalDistance/getBackgroundLocations` 호출 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-002 | background polling 중지 | Given polling 동작중, When `background`, Then 추가 polling 없음 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | 상태 전환 후 timer 진행해도 `getTotalDistance` 호출수 증가 없음 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-003 | active polling 재시작 | Given polling 중지 상태, When `active`, Then polling 재개 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `background→active` 전환 후 polling API 호출수 재증가 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-004 | 임계치 세그먼트 생성 | Given 거리 delta 10m 이상, When tick, Then `onSegmentCreate` | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `onSegmentCreate` 인자 검증 + `onDistanceUpdate` 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-005 | 임계치 미만 거리 업데이트 | Given 거리 delta 10m 미만, When tick, Then `onDistanceUpdate` | 경계값 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `onDistanceUpdate` 호출 + `onSegmentCreate` 미호출 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-006 | cleanup | Given polling 중, When unmount, Then listener/interval 정리 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `subscription.remove` 호출 + unmount 후 polling 호출수 고정 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-007 | background mode start/stop | Given background mode, When start/stop, Then background service 경로 사용 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `startBackgroundTracking/stopBackgroundTracking` 호출 + foreground 경로 미호출 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-008 | foreground mode start/stop | Given foreground mode, When start/stop, Then location service 경로 사용 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `startTracking/stopTracking` 호출 + background 경로 미호출 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-009 | pause/resume/reset 액션 | Given 러닝중, When pause/resume/reset, Then 상태/호출 정합성 유지 | 상태전이 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | `pauseTracking/resumeTracking` 호출 + reset 후 distance/locations/trackingData 초기화 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-010 | foreground subscription 분기 | Given foreground subscription, When distance 누적, Then onDistance/onSegment 분기 | 회귀(집계) | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | subscribe callback 직접 실행해 `onDistanceUpdate` 및 `onSegmentCreate` 분기 검증 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |
| GPS-LC-011 | polling 오류 복구 | Given polling 에러, When tick, Then throw 없이 오류 처리 | 오류 복구 | /Users/hongtaeho/running/runtaeho_app/src/features/running/__tests__/useGpsTracking.lifecycle.test.tsx | PASS | 에러 로그 검증 + segment 미생성 부정 단정 | PASS | PASS | V1~V6 충족 | F1~F6 충족 |

## Lifecycle Gate Results
| Feature | Unit 실행 | Coverage 대상 | Coverage 결과 | 시나리오 검증 |
|---|---|---|---|---|
| AppStateProvider | PASS | AppStateProvider lifecycle | Statements 83.05 / Branches 72 | PASS |
| useGpsTracking | PASS | useGpsTracking lifecycle | Statements 99.19 / Branches 84.61 | PASS |
